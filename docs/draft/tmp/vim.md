---
title: 胡说| VIM 初级使用
date: 2022-8-26
categories:
  - 编程知识
tags:
  - Linux
---

::: tip

:::

## vim简介


文本编辑器是对纯文本文件进行编辑、查看、修改等操作的软件
Windows下的记事本程序就是一个典型的文本编辑器
Linux系统下，纯文本文件用来 编写程序、命令脚本、配置软件和管理系统等


vi由加州大学伯克利分校BillJoy(sun创始人之一）开发
程序员必备十大代码编辑器中，vi/vim常年位居前列


vim是viimproved的简写
vim是vi编辑器的增强版
在UbuntuLinux中使用的是改进版的vim，通常也称为vi





vi 启动与退出

vi启动与退出
启动vi
1、打开终端
2、直接输入如下格式进入vi：
vi［文件名]
示例：
创建新文件：
vi newfile
打开已有文件：
vi/etc/passwd

vi启动与退出
退出vi
输入:wg可保存退出（:wg！强制保存并退出）
输入：g直接退出（原文件未修改）
输入：q！不保存文件，直接退出（原文件有修改）

vi 工作模式

vi工作模式
vi的工作状态分为三种模式
命令模式（commandmode）：输入命令，控制屏幕光标的移动：字符、字或行的删除
注意：命令不回显
插入模式(insertmode)：编辑文档文字输入、各种编辑
末行模式（lastlinemode）：转义模式文件保存或退出
设置编辑环境，如寻找字符串、列出行号...等



模式切换

（1）在操作系统提示符下键入vi，默认进入命令模式
（2）由命令模式进入输入方式，键入编辑命令，如：插入命令i
（3）由命令模式进入未行模式，只需键入冒号（：），每次只执行一条，执行完毕立即回到命令模式
（4）其他模式按ESC键，可到命令模式
（5）编辑模式和末行模式之间不能直接切换，须通过命令模式

vi基本应用

打开文件时，定位到指定位置处
（1）打开“/etc/passwd”文件并直接光标定位到第5行输入命令：vi+5/etc/passwd

（2）打开“/etc/passwd”文件，进入到含有某关键字的行，以“root”字串为关键字的行，输入命令:vi+/“root”/etc/passwd

编辑文件
1、进入编辑模式：
键入i，下方显示--插入
2、正常编辑一、行号、光标的设置
1、显示行号

OGPcai
末行模式下：:set number
或:set nu 取消行号:set nonu

2、移动光标
行移动
00或Home：光标移动到本行行首
$或End：光标移动到本行行尾
跳到指定的行［行号］G
：转到行号位置OG
：转到文件最后一行
：转到文件第一行
gg
屏幕滚动
ctrl + F
将屏幕向文件尾方向翻滚一整屏
将屏幕向文件，头；方向翻滚一整屏s/4/ictrl + B

二、文本操作（命令模式下

1、文本插入
进入文本编辑方式：

：插入当前字符前
插入当前字符后
在光标所在行之后新开一行
2、文本删除（命令模式）
X:删除光标处的单个字符
NX:删除光标处的n个字符
dd:删除当前行
ondd:删除从当前行起的行
3、恢复
u:取消上一次的编辑动作（可多次）



4、文本的搜索与替换
搜索：
查找wordo/word
1、命令模式下键入键，在窗口底部显示/，键入待搜索字符串，按回车从光标位置向下搜索
2、命令模式下键入？键，从光标位置向上搜索字符串n：继续向前查找（/和？方尚不同ON：与当前方尚相反的方尚尚前香查找

4、文本的搜索与替换
替换
os和S命令：
OS:用跟随在其后的字符串替换光标位置的字符
ons:用跟随在其后的字符串替换光标位置起的n个字符
oS:用跟随在其后的学符事替换当前行
onS：用跟随在其后的字符串替换当前行起的n行

4、文本的搜索与替换一末行模式
示例：
:s/this/hello
#将光标所在位置的this替换为hello

:s/this/hello/g
#将文件当前行this替换为hellc
：20s/this/hello/g#将文件第20行的所有this替换为hella
：1,30s/this/the/c#将文件第1行到第30行每行的第一个this
替换为the，替换前询问
：1,30s/this/the/g#将文件第1行到第30行的所有this替换为the

：1,$s/this/the/g#将文件所有行的所有this替换为the

5、文本的剪贴、复制、粘贴
示例常用命令：
yy：复制光标所在行
P：粘贴文本在光标处
dd：剪贴光标所在行的文本



6、常用的保存及退出命令：
：g一一原文未修改，不保存文件，直接退出vi
：q！一一不保存文件，强制退出“！”表示强制
性操作
:wg！一一强制保存文件并退出
:w一一保存并退出
:W保存当前文件
：W路径/文件名一一另存为一个新的文件相当于“另存为”功能

vi基本应用
多窗口编辑
（1）在vi中依次打开两个文件：
(1)输入命令vi文件名1，打开一个文件1
（2在已打开的文件1中，按【Esc】回到命令模式
输入命令：sp文件名2，同时打开这两个文件

（2）光标在两个窗口中的切换
(1）如果当前光标处于下面窗口的文件中，则单击
【Esc】一一>【Ctrl+w】一一>【k】/方向键t，使
光标定位到上面的窗口
如果当前光标处于上面窗口的文件中，则单击
【Esc】一一>【Ctrl+w】一一>【i】/方向键}，使光标定位到下面的窗口

全文复制
如果在编辑某个文件时，要将另一个窗口的文件全
部复制到当前文件中，命令模式下，操作：r被复制的文件名）区域复制

（1）打开某文件，光标移动到需要复制第一行
单击【ESC键，确保当前处于命令模式，再单
击组合键【Ctrl+v】
使用小键盘的上下左右方向键，进行区域选取

单击【Y】键结束区域选取
5光标移至目标位置，单击【P键实现区域复制在vi中实现与shell的交互
在vi进行文件编辑时，使用“！”命令来访
问Shell执行Shell命令的格式如下：:！ Shell命令
执行的结果将显示在vi中，单击【Enter】键，继续进行编辑工作



## vi/vim 使用实例



### 第一部分：一般模式可用的光标移动、复制粘贴、搜索替换等

| 移动光标的方法                                               |                                                              |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| h 或 向左箭头键 (←)                                          | 光标向左移动一个字符                                         |
| j 或 向下箭头键 (↓)                                          | 光标向下移动一个字符                                         |
| k 或 向上箭头键 (↑)                                          | 光标向上移动一个字符                                         |
| l 或 向右箭头键 (→)                                          | 光标向右移动一个字符                                         |
| 如果你将右手放在键盘上的话，你会发现 hjkl 是排列在一起的，因此可以使用这四个按钮来移动光标。 如果想要进行多次移动的话，例如向下移动 30 行，可以使用 "30j" 或 "30↓" 的组合按键， 亦即加上想要进行的次数 (数字) 后，按下动作即可！ |                                                              |
| [Ctrl] + [f]                                                 | 屏幕『向下』移动一页，相当于 [Page Down] 按键 (常用)         |
| [Ctrl] + [b]                                                 | 屏幕『向上』移动一页，相当于 [Page Up] 按键 (常用)           |
| [Ctrl] + [d]                                                 | 屏幕『向下』移动半页                                         |
| [Ctrl] + [u]                                                 | 屏幕『向上』移动半页                                         |
| +                                                            | 光标移动到非空格符的下一行                                   |
| -                                                            | 光标移动到非空格符的上一行                                   |
| n<space>                                                     | 那个 n 表示『数字』，例如 20 。按下数字后再按空格键，光标会向右移动这一行的 n 个字符。例如 20<space> 则光标会向后面移动 20 个字符距离。 |
| 0 或功能键 [Home]                                            | 这是数字『 0 』：移动到这一行的最前面字符处 (常用)           |
| $ 或功能键 [End]                                             | 移动到这一行的最后面字符处 (常用)                            |
| H                                                            | 光标移动到这个屏幕的最上方那一行的第一个字符                 |
| M                                                            | 光标移动到这个屏幕的中央那一行的第一个字符                   |
| L                                                            | 光标移动到这个屏幕的最下方那一行的第一个字符                 |
| G                                                            | 移动到这个档案的最后一行 (常用)                              |
| nG                                                           | n 为数字。移动到这个档案的第 n 行。例如 20G 则会移动到这个档案的第 20 行 (可配合 :set nu) |
| gg                                                           | 移动到这个档案的第一行，相当于 1G 啊！ (常用)                |
| n<Enter>                                                     | n 为数字。光标向下移动 n 行 (常用)                           |
| 搜索替换                                                     |                                                              |
| /word                                                        | 向光标之下寻找一个名称为 word 的字符串。例如要在档案内搜寻 vbird 这个字符串，就输入 /vbird 即可！ (常用) |
| ?word                                                        | 向光标之上寻找一个字符串名称为 word 的字符串。               |
| n                                                            | 这个 n 是英文按键。代表重复前一个搜寻的动作。举例来说， 如果刚刚我们执行 /vbird 去向下搜寻 vbird 这个字符串，则按下 n 后，会向下继续搜寻下一个名称为 vbird 的字符串。如果是执行？vbird 的话，那么按下 n 则会向上继续搜寻名称为 vbird 的字符串！ |
| N                                                            | 这个 N 是英文按键。与 n 刚好相反，为『反向』进行前一个搜寻动作。 例如 /vbird 后，按下 N 则表示『向上』搜寻 vbird 。 |
| 使用 /word 配合 n 及 N 是非常有帮助的！可以让你重复的找到一些你搜寻的关键词！ |                                                              |
| :n1,n2s/word1/word2/g                                        | n1 与 n2 为数字。在第 n1 与 n2 行之间寻找 word1 这个字符串，并将该字符串取代为 word2 ！举例来说，在 100 到 200 行之间搜寻 vbird 并取代为 VBIRD 则： 『:100,200s/vbird/VBIRD/g』。(常用) |
| :1,$s/word1/word2/g 或 :%s/word1/word2/g                     | 从第一行到最后一行寻找 word1 字符串，并将该字符串取代为 word2 ！(常用) |
| :1,$s/word1/word2/gc 或 :%s/word1/word2/gc                   | 从第一行到最后一行寻找 word1 字符串，并将该字符串取代为 word2 ！且在取代前显示提示字符给用户确认 (confirm) 是否需要取代！(常用) |
| 删除、复制与贴上                                             |                                                              |
| x, X                                                         | 在一行字当中，x 为向后删除一个字符 (相当于 [del] 按键)， X 为向前删除一个字符 (相当于 [backspace] 亦即是退格键) (常用) |
| nx                                                           | n 为数字，连续向后删除 n 个字符。举例来说，我要连续删除 10 个字符， 『10x』。 |
| dd                                                           | 删除游标所在的那一整行 (常用)                                |
| ndd                                                          | n 为数字。删除光标所在的向下 n 行，例如 20dd 则是删除 20 行 (常用) |
| d1G                                                          | 删除光标所在到第一行的所有数据                               |
| dG                                                           | 删除光标所在到最后一行的所有数据                             |
| d$                                                           | 删除游标所在处，到该行的最后一个字符                         |
| d0                                                           | 那个是数字的 0 ，删除游标所在处，到该行的最前面一个字符      |
| yy                                                           | 复制游标所在的那一行 (常用)                                  |
| nyy                                                          | n 为数字。复制光标所在的向下 n 行，例如 20yy 则是复制 20 行 (常用) |
| y1G                                                          | 复制游标所在行到第一行的所有数据                             |
| yG                                                           | 复制游标所在行到最后一行的所有数据                           |
| y0                                                           | 复制光标所在的那个字符到该行行首的所有数据                   |
| y$                                                           | 复制光标所在的那个字符到该行行尾的所有数据                   |
| p, P                                                         | p 为将已复制的数据在光标下一行贴上，P 则为贴在游标上一行！ 举例来说，我目前光标在第 20 行，且已经复制了 10 行数据。则按下 p 后， 那 10 行数据会贴在原本的 20 行之后，亦即由 21 行开始贴。但如果是按下 P 呢？ 那么原本的第 20 行会被推到变成 30 行。 (常用) |
| J                                                            | 将光标所在行与下一行的数据结合成同一行                       |
| c                                                            | 重复删除多个数据，例如向下删除 10 行，[10cj]                 |
| u                                                            | 复原前一个动作。(常用)                                       |
| [Ctrl]+r                                                     | 重做上一个动作。(常用)                                       |
| 这个 u 与 [Ctrl]+r 是很常用的指令！一个是复原，另一个则是重做一次～ 利用这两个功能按键，你的编辑，嘿嘿！很快乐的啦！ |                                                              |
| .                                                            | 不要怀疑！这就是小数点！意思是重复前一个动作的意思。 如果你想要重复删除、重复贴上等等动作，按下小数点『.』就好了！ (常用) |



### 第二部分：一般模式切换到编辑模式的可用的按钮说明

| 进入输入或取代的编辑模式                                     |                                                              |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| i, I                                                         | 进入输入模式 (Insert mode)： i 为『从目前光标所在处输入』， I 为『在目前所在行的第一个非空格符处开始输入』。 (常用) |
| a, A                                                         | 进入输入模式 (Insert mode)： a 为『从目前光标所在的下一个字符处开始输入』， A 为『从光标所在行的最后一个字符处开始输入』。(常用) |
| o, O                                                         | 进入输入模式 (Insert mode)： 这是英文字母 o 的大小写。o 为『在目前光标所在的下一行处输入新的一行』； O 为在目前光标所在处的上一行输入新的一行！(常用) |
| r, R                                                         | 进入取代模式 (Replace mode)： r 只会取代光标所在的那一个字符一次；R 会一直取代光标所在的文字，直到按下 ESC 为止；(常用) |
| 上面这些按键中，在 vi 画面的左下角处会出现『--INSERT--』或『--REPLACE--』的字样。 由名称就知道该动作了吧！！特别注意的是，我们上面也提过了，你想要在档案里面输入字符时， 一定要在左下角处看到 INSERT 或 REPLACE 才能输入喔！ |                                                              |
| [Esc]                                                        | 退出编辑模式，回到一般模式中 (常用)                          |



### 第三部分：一般模式切换到指令行模式的可用的按钮说明

| 指令行的储存、离开等指令                                     |                                                              |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| :w                                                           | 将编辑的数据写入硬盘档案中 (常用)                            |
| :w!                                                          | 若文件属性为『只读』时，强制写入该档案。不过，到底能不能写入， 还是跟你对该档案的档案权限有关啊！ |
| :q                                                           | 离开 vi (常用)                                               |
| :q!                                                          | 若曾修改过档案，又不想储存，使用！为强制离开不储存档案。     |
| 注意一下啊，那个惊叹号 (!) 在 vi 当中，常常具有『强制』的意思～ |                                                              |
| :wq                                                          | 储存后离开，若为 :wq! 则为强制储存后离开 (常用)              |
| ZZ                                                           | 这是大写的 Z 喔！若档案没有更动，则不储存离开，若档案已经被更动过，则储存后离开！ |
| :w [filename]                                                | 将编辑的数据储存成另一个档案（类似另存新档）                 |
| :r [filename]                                                | 在编辑的数据中，读入另一个档案的数据。亦即将 『filename』 这个档案内容加到游标所在行后面 |
| :n1,n2 w [filename]                                          | 将 n1 到 n2 的内容储存成 filename 这个档案。                 |
| :! command                                                   | 暂时离开 vi 到指令行模式下执行 command 的显示结果！例如 『:! ls /home』即可在 vi 当中察看 /home 底下以 ls 输出的档案信息！ |
| vim 环境的变更                                               |                                                              |
| :set nu                                                      | 显示行号，设定之后，会在每一行的前缀显示该行的行号           |
| :set nonu                                                    | 与 set nu 相反，为取消行号！                                 |



- https://reinness.com/posts/80