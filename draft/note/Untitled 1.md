## 缓存穿透

缓存穿透是指客户端请求的数据在缓存中和数据库中都不存在，这样缓存永远不会生效，这些请求都会打到数据库。

> **注意：缓存穿透前提是：Redis和MySQL中都没有，然后不停的直接请求MySQL。**

### 缓存空对象

优点：实现简单，维护方便。

缺点：额外的内存消耗，可能造成短期的不一致。

### 布隆过滤

布隆过滤器是一种数据结构，对所有可能查询的参数以hash形式存储，在控制层先进行校验，不符合则 丢弃，从而避免了对底层存储系统的查询压力；

优点：内存占用较少，没有多余key。

缺点：实现复杂，存在误判可能（有穿透的风险），无法删除数据。

### 主动预防缓存穿透

- 增强id的复杂度避免被猜测id规律

- 做好数据的基础格式校验
- 加强用户权限校验
- 做好热点参数的限流。





## 缓存击穿

缓存击穿问题也叫热点Key问题，就是一个被高并发访问并且缓存重建业务较复杂的key突然失效了，无数的请求访问会在瞬间给数据库带来巨大的冲击。

### 互斥锁（时间换空间）

优点：内存占用小，一致性高，实现简单。
缺点：性能较低，容易出现死锁。

### 逻辑过期（空间换时间）

**设置热点key永不过期**

优点：性能高。
缺点：内存占用较大，容易出现脏读。



## 缓存雪崩的解决方案

缓存雪崩是指在同一时段大量的缓存key同时失效或者Redis服务宕机，导致大量请求到达数据库，带来巨大压力。

### Redis高可用

利用Redis集群提高服务的可用性

### 限流降级

在缓存失效后，通过加锁或者队列来控制读数据库写缓存的线程数量。比如对 某个key只允许一个线程查询数据和写缓存，其他线程等待。给缓存业务添加降级限流策略，比如快速失败机制，让请求尽可能打不到数据库上

### 数据预热

在即将发生大并发访问前手动触发加载缓存不同的key，设置不同的过期时间，**让缓存失效的时间点尽量均匀** 