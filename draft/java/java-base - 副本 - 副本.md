以下是高可用系统设计指南的总结：

### 什么是高可用？可用性的判断标准是啥？
- **高可用定义**：高可用描述的是一个系统在大部分时间都是可用的，可以为我们提供服务的。即使在发生硬件故障或者系统升级的时候，服务仍然是可用的。
- **可用性判断标准**：一般使用多少个9来评判一个系统的可用性，例如99.9999%代表该系统在所有的运行时间中只有0.0001%的时间是不可用的。此外，还可以用某功能的失败次数与总的请求次数之比来衡量，如对网站请求1000次，其中有10次请求失败，那么可用性就是99%。

### 哪些情况会导致系统不可用？
- 黑客攻击。
- 硬件故障，比如服务器坏掉。
- 并发量/用户请求量激增导致整个服务宕掉或者部分服务不可用。
- 代码中的坏味道导致内存泄漏或者其他问题导致程序挂掉。
- 网站架构某个重要的角色比如Nginx或者数据库突然不可用。
- 自然灾害或者人为破坏。

### 有哪些提高系统可用性的方法？
- **注重代码质量，测试严格把关**：代码质量是系统可用性的基础，如内存泄漏、循环依赖等都会对系统可用性造成损害。提高代码质量的方法包括CodeReview、使用Sonarqube、Arthas、阿里巴巴Java代码规范等工具。
- **使用集群，减少单点故障**：通过使用集群，如Redis集群，避免单点故障，提高系统的可用性。
- **限流**：监控应用流量的QPS或并发线程数等指标，当达到指定的阈值时对流量进行控制，避免被瞬时的流量高峰冲垮。
- **超时和重试机制设置**：对用户请求设置超时时间，一旦超过该时间未得到响应则抛出异常。重试次数一般设为3次，过多的重试会加重服务器压力。
- **熔断机制**：系统自动收集所依赖服务的资源使用情况和性能指标，当所依赖的服务恶化或者调用失败次数达到某个阈值时迅速失败，让当前系统立即切换依赖其他备用服务。
- **异步调用**：用户请求完成之后立即返回结果，具体处理后续再做，如使用消息队列进行异步处理，提高系统性能并降低系统耦合性。
- **使用缓存**：对于并发量高的系统，使用缓存存储热点数据，提高数据读取速度，减轻数据库压力。
- **其他**：核心应用和服务优先使用更好的硬件；监控系统资源使用情况增加报警设置；注意备份，必要时候回滚；灰度发布；定期检查/更换硬件。

