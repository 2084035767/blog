---
title: èƒ¡è¯´| CLI åŒ å¿ƒåˆ¶ä½œ
date: 2022-8-26
categories:
  - ç¼–ç¨‹çŸ¥è¯†
tags:
  - CLI
---

:::tip

:::

# CLI åŒ å¿ƒåˆ¶ä½œ



## å¼•è¨€

å‘½ä»¤è¡Œç•Œé¢ï¼ˆCommand-Line Interface, CLIï¼‰ä½œä¸ºå¼€å‘è€…ä¸è®¡ç®—æœºäº¤äº’çš„æ ¸å¿ƒå·¥å…·ï¼Œå‡­å€Ÿå…¶é«˜æ•ˆã€çµæ´»çš„ç‰¹æ€§ï¼Œåœ¨ç°ä»£å¼€å‘ä¸­å æ®é‡è¦åœ°ä½ã€‚æ— è®ºæ˜¯è‡ªåŠ¨åŒ–è„šæœ¬ã€ç³»ç»Ÿç®¡ç†ï¼Œè¿˜æ˜¯å¤æ‚åº”ç”¨çš„è°ƒè¯•ï¼ŒCLI éƒ½å±•ç°äº†ä¸å¯æ›¿ä»£çš„ä¼˜åŠ¿ã€‚æœ¬æ–‡å°†ä» CLI çš„åŸºç¡€æ¦‚å¿µå‡ºå‘ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ å¦‚ä½•ä»é›¶å¼€å‘ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å‘½ä»¤è¡Œå·¥å…·ã€‚



## CLI ç®€ä»‹

### ä»€ä¹ˆæ˜¯ CLIï¼Ÿ
CLI æ˜¯ä¸€ç§é€šè¿‡æ–‡æœ¬å‘½ä»¤ä¸è®¡ç®—æœºç³»ç»Ÿäº¤äº’çš„ç•Œé¢ã€‚ç”¨æˆ·è¾“å…¥ç‰¹å®šæŒ‡ä»¤ï¼Œç³»ç»Ÿè§£æå¹¶æ‰§è¡Œåè¿”å›ç»“æœã€‚ä¸å›¾å½¢ç•Œé¢ï¼ˆGUIï¼‰ç›¸æ¯”ï¼ŒCLI çš„ä¼˜åŠ¿åœ¨äºï¼š
- **é«˜æ•ˆ**ï¼šé€šè¿‡ç®€æ´å‘½ä»¤å¿«é€Ÿå®Œæˆå¤æ‚æ“ä½œï¼ˆå¦‚æ‰¹é‡æ–‡ä»¶å¤„ç†ï¼‰ã€‚
- **è‡ªåŠ¨åŒ–**ï¼šæ”¯æŒè„šæœ¬åŒ–æ‰§è¡Œï¼Œé€‚åˆé›†æˆåˆ° CI/CD æµç¨‹ã€‚
- **ä½èµ„æºæ¶ˆè€—**ï¼šæ— éœ€å›¾å½¢æ¸²æŸ“ï¼Œé€‚åˆè¿œç¨‹æœåŠ¡å™¨ç®¡ç†ã€‚

### å¸¸è§ CLI å·¥å…·ç¤ºä¾‹
- `git`ï¼šä»£ç ç‰ˆæœ¬æ§åˆ¶ã€‚
- `curl`ï¼šç½‘ç»œè¯·æ±‚è°ƒè¯•ã€‚
- `docker`ï¼šå®¹å™¨ç®¡ç†ã€‚



## CLI åˆ¶ä½œæµç¨‹

### 1. é€‰æ‹©å¼€å‘è¯­è¨€ä¸å·¥å…·
CLI å·¥å…·å¯ä»¥ç”¨å¤šç§è¯­è¨€å®ç°ï¼Œæ¨èé€‰æ‹©ç”Ÿæ€æˆç†Ÿçš„é€‰é¡¹ï¼š
- **Python**ï¼šç®€å•æ˜“ç”¨ï¼Œé€‚åˆå¿«é€Ÿå¼€å‘ï¼ˆåº“ï¼š`argparse`ã€`click`ï¼‰ã€‚
- **Node.js**ï¼šç”Ÿæ€ä¸°å¯Œï¼Œæ”¯æŒè·¨å¹³å°ï¼ˆåº“ï¼š`commander.js`ã€`yargs`ï¼‰ã€‚
- **Go**ï¼šç¼–è¯‘ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ— éœ€ç¯å¢ƒä¾èµ–ï¼ˆåº“ï¼š`cobra`ï¼‰ã€‚

### 2. è®¾è®¡å‘½ä»¤ä¸å‚æ•°
ä¸€ä¸ª CLI å·¥å…·çš„æ ¸å¿ƒæ˜¯**å‘½ä»¤ç»“æ„**ã€‚ä»¥æ–‡ä»¶ç®¡ç†å·¥å…·ä¸ºä¾‹ï¼š
```plaintext
mycli create <filename>  # åˆ›å»ºæ–‡ä»¶
mycli delete <filename>  # åˆ é™¤æ–‡ä»¶
mycli list --dir=/path   # åˆ—å‡ºç›®å½•å†…å®¹
```
éœ€æ˜ç¡®ï¼š
- **å­å‘½ä»¤**ï¼ˆå¦‚ `create`ã€`delete`ï¼‰ã€‚
- **å‚æ•°ç±»å‹**ï¼ˆä½ç½®å‚æ•°ã€å¯é€‰æ ‡å¿—ï¼‰ã€‚
- **å¸®åŠ©æ–‡æ¡£**ï¼ˆé€šè¿‡ `--help` è‡ªåŠ¨ç”Ÿæˆï¼‰ã€‚

### 3. å®ç°æ ¸å¿ƒé€»è¾‘ï¼ˆä»¥ Python ä¸ºä¾‹ï¼‰
ä½¿ç”¨ `argparse` åº“è§£æå‘½ä»¤è¡Œå‚æ•°ï¼š
```python
import argparse

def main():
    parser = argparse.ArgumentParser(description="æ–‡ä»¶ç®¡ç†å·¥å…·")
    subparsers = parser.add_subparsers(dest="command")

    # åˆ›å»ºå­å‘½ä»¤ï¼šcreate
    create_parser = subparsers.add_parser("create", help="åˆ›å»ºæ–‡ä»¶")
    create_parser.add_argument("filename", type=str, help="æ–‡ä»¶å")

    # è§£æå‚æ•°å¹¶æ‰§è¡Œé€»è¾‘
    args = parser.parse_args()
    if args.command == "create":
        with open(args.filename, "w") as f:
            f.write("")
        print(f"æ–‡ä»¶ {args.filename} åˆ›å»ºæˆåŠŸï¼")

if __name__ == "__main__":
    main()
```

### 4. å¢å¼ºåŠŸèƒ½
- **é¢œè‰²è¾“å‡º**ï¼šä½¿ç”¨ `rich` æˆ– `chalk` åº“æå‡å¯è¯»æ€§ã€‚
- **è¿›åº¦æ¡**ï¼šé›†æˆ `tqdm` æ˜¾ç¤ºé•¿ä»»åŠ¡è¿›åº¦ã€‚
- **é…ç½®æ–‡ä»¶**ï¼šæ”¯æŒ `~/.myclirc` è¯»å–ç”¨æˆ·é»˜è®¤è®¾ç½®ã€‚

### 5. æ‰“åŒ…ä¸åˆ†å‘
- **Python**ï¼šä½¿ç”¨ `setuptools` ç”Ÿæˆ `pip` åŒ…ã€‚
- **Node.js**ï¼šé€šè¿‡ `npm publish` å‘å¸ƒåˆ° npm ä»“åº“ã€‚
- **Go**ï¼šç¼–è¯‘ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç›´æ¥åˆ†å‘ã€‚



## å®æˆ˜æ¡ˆä¾‹ï¼šå¼€å‘ä¸€ä¸ª Markdown è½¬æ¢å·¥å…·

### åŠŸèƒ½éœ€æ±‚
- å°† Markdown æ–‡ä»¶è½¬æ¢ä¸º HTMLã€‚
- æ”¯æŒè‡ªå®šä¹‰è¾“å‡ºç›®å½•ã€‚
- æ˜¾ç¤ºè½¬æ¢è€—æ—¶ã€‚

### å®ç°æ­¥éª¤ï¼ˆNode.js + `commander.js`ï¼‰
1. åˆå§‹åŒ–é¡¹ç›®ï¼š
   ```bash
   npm init -y
   npm install commander marked
   ```

2. ç¼–å†™ä»£ç  `md2html.js`ï¼š
   ```javascript
   const { program } = require('commander');
   const fs = require('fs');
   const marked = require('marked');
   
   program
     .version('1.0.0')
     .description('Markdown è½¬ HTML å·¥å…·');
   
   program
     .command('convert <input>')
     .option('-o, --output <dir>', 'è¾“å‡ºç›®å½•')
     .action((input, options) => {
       const start = Date.now();
       const mdContent = fs.readFileSync(input, 'utf8');
       const htmlContent = marked.parse(mdContent);
       const outputPath = options.output || './output.html';
       fs.writeFileSync(outputPath, htmlContent);
       console.log(`è½¬æ¢å®Œæˆï¼è€—æ—¶ ${Date.now() - start}ms`);
     });
   
   program.parse();
   ```

3. æµ‹è¯•è¿è¡Œï¼š
   ```bash
   node md2html.js convert README.md -o docs/index.html
   ```



## æœ€ä½³å®è·µ

1. **æ¸…æ™°çš„å¸®åŠ©æ–‡æ¡£**ï¼šç¡®ä¿æ¯ä¸ªå‘½ä»¤å’Œå‚æ•°éƒ½æœ‰ç®€æ´è¯´æ˜ã€‚
2. **é”™è¯¯å¤„ç†**ï¼šæ•è·å¼‚å¸¸å¹¶æä¾›å‹å¥½æç¤ºï¼ˆå¦‚æ–‡ä»¶ä¸å­˜åœ¨ï¼‰ã€‚
3. **è·¨å¹³å°å…¼å®¹**ï¼šå¤„ç†è·¯å¾„åˆ†éš”ç¬¦ï¼ˆ`/` vs `\`ï¼‰å’Œç¯å¢ƒå˜é‡ã€‚
4. **å•å…ƒæµ‹è¯•**ï¼šä½¿ç”¨ `Jest` æˆ– `pytest` éªŒè¯æ ¸å¿ƒé€»è¾‘ã€‚



## æ¨èå·¥å…·ä¸èµ„æº

- **å¼€å‘åº“**ï¼š
  - Pythonï¼š[Typer](https://typer.tiangolo.com/)ï¼ˆæ›´ç°ä»£çš„ CLI æ¡†æ¶ï¼‰ã€‚
  - Node.jsï¼š[oclif](https://oclif.io/)ï¼ˆä¼ä¸šçº§ CLI å¼€å‘æ¡†æ¶ï¼‰ã€‚
- **è°ƒè¯•å·¥å…·**ï¼š`console.log` è°ƒè¯•åŸºç¡€ï¼Œè¿›é˜¶ä½¿ç”¨ `debug` åº“ã€‚
- **å­¦ä¹ èµ„æº**ï¼š
  - [å‘½ä»¤è¡Œè‰ºæœ¯](https://github.com/jlevy/the-art-of-command-line)
  - [Node.js CLI æœ€ä½³å®è·µ](https://www.twilio.com/blog/how-to-build-a-cli-with-node-js)

---

## ç»“è¯­

CLI å·¥å…·çš„å¼€å‘ä¸ä»…æ˜¯æŠ€æœ¯å®è·µï¼Œæ›´æ˜¯å¯¹ç”¨æˆ·ä½“éªŒçš„æ·±å…¥æ€è€ƒã€‚é€šè¿‡åˆç†è®¾è®¡å‘½ä»¤ã€ä¼˜åŒ–äº¤äº’ç»†èŠ‚ï¼Œä½ å¯ä»¥æ‰“é€ å‡ºé«˜æ•ˆä¸”å—æ¬¢è¿çš„å‘½ä»¤è¡Œå·¥å…·ã€‚æ— è®ºæ˜¯ä¸ªäººæ•ˆç‡æå‡ï¼Œè¿˜æ˜¯å›¢é˜Ÿåä½œï¼ŒæŒæ¡ CLI å¼€å‘éƒ½å°†ä¸ºä½ æ‰“å¼€ä¸€æ‰‡æ–°çš„å¤§é—¨ã€‚ç°åœ¨ï¼ŒåŠ¨æ‰‹å®ç°ä½ çš„ç¬¬ä¸€ä¸ª CLI é¡¹ç›®å§ï¼ğŸš€